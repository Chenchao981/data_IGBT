# FT数据清洗工具 - GUI版本

## 概述

FT数据清洗工具是一个基于PyQt5的图形界面程序，集成了DC、DVDS、RG三种数据清洗功能，为用户提供统一、友好的操作界面。

## 功能特性

### 🎯 核心功能
- **多类型数据清洗**：支持DC、DVDS、RG三种清洗模式
- **单选操作**：每次只能选择一种清洗类型执行
- **可视化界面**：现代化的GUI设计，操作直观
- **实时状态反馈**：显示处理进度和详细日志信息
- **多线程处理**：后台清洗不阻塞界面响应

### 🛠️ 界面组件
1. **清洗类型选择**：DC、DVDS、RG单选按钮
2. **文件夹选择**：数据输入文件夹和输出文件夹选择
3. **操作按钮**：开始清洗数据按钮（居中显示）
4. **状态显示**：实时显示处理状态和日志信息

## 安装要求

### 系统要求
- Windows 10/11
- Python 3.7+

### 依赖包
```bash
pip install -r ../requirements.txt
```

主要依赖：
- PyQt5 >= 5.15.0
- pandas >= 1.5.0
- openpyxl >= 3.0.0
- calamine >= 0.2.0
- xlsxwriter >= 3.0.0

## 使用方法

### 启动程序
```bash
# 在项目根目录执行
cd gui
python ft_data_cleaner_gui.py
```

或者从项目根目录：
```bash
python gui/ft_data_cleaner_gui.py
```

### 操作步骤

1. **选择清洗类型**
   - 在"清洗类型选择"区域选择DC、DVDS或RG
   - 每次只能选择一种类型

2. **选择输入文件夹**
   - 点击"选择文件夹..."按钮
   - 支持以下三种选择方式：
     - **方式1**: 选择包含ASEData文件夹的根目录
     - **方式2**: 直接选择ASEData文件夹
     - **方式3**: 直接选择具体的数据目录（如ASEData/DC）
   - 程序会智能识别并自动构建正确的路径
   - 默认设置为用户桌面路径

3. **选择输出文件夹**
   - 点击"选择文件夹..."按钮
   - 选择清洗后数据的保存位置
   - 程序默认设置为用户桌面路径

4. **开始清洗**
   - 点击"🚀 开始清洗数据"按钮
   - 观察"处理状态"区域的实时日志信息
   - 等待处理完成

5. **查看结果**
   - 清洗完成后会显示成功/失败消息
   - 成功的文件会保存在指定的输出目录

## 技术架构

### 🏗️ 代码结构
```
gui/
├── ft_data_cleaner_gui.py          # 主程序文件
├── README.md                       # 本文档
└── [未来扩展文件]
```

### 🔧 主要类说明

#### `FTDataCleanerGUI` (主界面类)
- **职责**：管理GUI界面、用户交互、界面样式
- **关键方法**：
  - `init_ui()`: 初始化界面组件
  - `start_cleaning()`: 启动数据清洗流程
  - `setup_default_paths()`: 设置默认路径

#### `DataCleanerWorker` (工作线程类)
- **职责**：在后台执行数据清洗任务，避免界面卡顿
- **支持的清洗器**：
  - DC清洗器 (`DCDataCleaner`)
  - DVDS清洗器 (`DVDSCleaner`)  
  - RG清洗器 (`RGCleaner`)

### 🎨 界面设计
- **风格**：现代化扁平设计
- **色彩**：蓝色主题配色
- **布局**：垂直布局，组件分组显示
- **响应式**：支持窗口大小调整

## 日志和调试

### 日志输出
- **GUI日志**：实时显示在"处理状态"区域
- **详细日志**：各清洗器会生成独立的.log文件：
  - `dc_processing/dc_cleaner.log`
  - `dvds_processing/dvds_cleaner.log`
  - `rg_processing/rg_cleaner.log`

### 常见问题

#### 1. 导入错误
**问题**：`ModuleNotFoundError: No module named 'dc_cleaner'`
**解决**：确保项目目录结构正确，清洗器模块在正确位置

#### 2. 路径问题
**问题**：`输入目录不存在`
**解决**：检查选择的文件夹是否包含相应的数据文件

#### 3. PyQt5安装问题
**问题**：`No module named 'PyQt5'`
**解决**：
```bash
pip install PyQt5
```

## 开发和扩展

### 添加新的清洗类型
1. 在相应目录创建清洗器模块
2. 在`DataCleanerWorker`类中添加对应的`_run_xxx_cleaner()`方法
3. 在GUI界面添加新的单选按钮
4. 更新路径处理逻辑

### 界面美化
- 修改`set_styles()`方法中的CSS样式
- 添加图标文件并设置`setWindowIcon()`
- 调整布局和组件大小

### 功能扩展
- 添加进度条显示
- 支持批量处理多种类型
- 添加数据预览功能
- 集成图表生成功能

## 版本历史

### v1.2 (2025-01-20)
- ✅ 修复路径识别问题，智能判断用户选择的路径类型
- ✅ 支持多种路径选择方式（根目录/ASEData目录/具体数据目录）
- ✅ 改进错误提示信息，提供更明确的解决方案

### v1.1 (2025-01-20)
- ✅ 移除"生成图表"按钮，专注数据清洗功能
- ✅ 优化按钮布局，清洗按钮居中显示
- ✅ 修改文件命名规则为"lot_id_类型_时间戳"格式
- ✅ 默认路径改为用户桌面，提升用户体验

### v1.0 (2025-01-20)
- ✅ 基础GUI界面实现
- ✅ 集成DC、DVDS、RG三种清洗功能
- ✅ 多线程处理支持
- ✅ 实时状态显示
- ✅ 智能路径管理

## 贡献指南

1. 遵循现有代码风格
2. 添加适当的注释和文档
3. 测试新功能的兼容性
4. 更新README文档

## 许可证

本项目遵循项目根目录的许可证文件。

---

**开发者**: cc  
**创建时间**: 2025-01-20  
**最后更新**: 2025-01-20 