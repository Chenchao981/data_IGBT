#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
测试DVDS数据提取功能
"""

import os
import sys

from dvds_cleaner import DVDSCleaner

def test_extract_single_file():
    """测试单个文件的数据提取"""
    print("=" * 60)
    print("测试DVDS数据提取功能")
    print("=" * 60)
    
    # 创建清洗器实例
    cleaner = DVDSCleaner()
    
    # 获取文件列表
    files = cleaner.scan_dvds_files()
    
    if not files:
        print("❌ 未找到任何文件")
        return
    
    # 测试第一个文件
    test_file = files[0]
    filename = os.path.basename(test_file)
    print(f"\n测试文件: {filename}")
    
    # 提取数据
    result_df = cleaner.extract_dvds_data(test_file)
    
    if result_df.empty:
        print("❌ 数据提取失败")
        return
    
    print(f"\n✅ 数据提取成功!")
    print(f"数据形状: {result_df.shape}")
    print(f"列名: {list(result_df.columns)}")
    
    print(f"\n前10行数据:")
    print(result_df.head(10).to_string(index=False))
    
    print(f"\n数据统计:")
    dvds_col = result_df.columns[1]  # DVDS列
    print(f"总数据点: {len(result_df)}")
    print(f"DVDS最小值: {result_df[dvds_col].min()}")
    print(f"DVDS最大值: {result_df[dvds_col].max()}")
    print(f"DVDS平均值: {result_df[dvds_col].mean():.2f}")
    
    print(f"\n" + "=" * 60)
    print("Phase 2数据提取测试完成")
    print("=" * 60)

if __name__ == "__main__":
    test_extract_single_file() 